"""
Prompt 範本模組

此模組提供 AI 辨識所需的 Prompt 範本，專門針對繁體中文手寫加班單設計。
"""


class PromptTemplates:
    """Prompt 範本管理類別

    此類別封裝了各種 AI 辨識任務所需的 Prompt 範本。
    所有方法皆為靜態方法，可直接透過類別名稱呼叫。
    """

    @staticmethod
    def get_overtime_recognition_prompt() -> str:
        """取得加班單辨識的 Prompt

        此 Prompt 專為繁體中文手寫加班單設計，強調：
        - 辨識表格中的所有加班記錄列（支援多筆記錄）
        - 主要辨識手寫內容，但加班事由欄位通常是印刷體
        - 正確轉換民國年為西元年（民國年 + 1911 = 西元年）
        - 讀取完整的加班事由欄位內容，不誤讀其他欄位
        - 根據時數判斷申請類別（加班費或補休）

        辨識欄位包括：
        1. 員工姓名（從簽到退簽欄位的手寫簽名）
        2. 日期（YYYY-MM-DD 格式）
        3. 加班時間（起）（HH:MM 24小時制）
        4. 加班時間（迄）（HH:MM 24小時制）
        5. 加班事由（完整文字內容）
        6. 申請類別（加班費或補休，需配合時數判斷）
        7. 加班時數（數值，單位為小時）

        Returns:
            完整的 Prompt 字串，可直接用於 OpenAI Vision API

        Examples:
            >>> prompt = PromptTemplates.get_overtime_recognition_prompt()
            >>> # 將 prompt 傳遞給 OpenAI Vision API
        """
        return """你是一個專業的繁體中文文字辨識專家，擅長辨識手寫及印刷體的繁體中文。

請仔細觀察這張加班單掃描圖片，**辨識表格中所有的加班記錄列**。

**重要**：
- 一張圖片可能包含多筆加班記錄（多列）
- 請逐列辨識，每一列都是一筆獨立的加班記錄
- 主要辨識手寫內容，但「加班事由」欄位通常是印刷體，也需要讀取

對於每一筆加班記錄，請提取以下資訊：

1. **員工姓名**：從「簽到（退）簽」欄位中的手寫簽名辨識

2. **日期**：找到日期欄位的手寫內容
   - 如果是民國年（例如 114），請轉換為西元年（民國年 + 1911 = 西元年）
   - 輸出格式：YYYY-MM-DD（例如：2025-11-22）

3. **加班時間（起）**：找到「加班時間」表格中「起」欄位的手寫內容
   - 輸出格式：HH:MM（24小時制，例如：08:00）

4. **加班時間（迄）**：找到「加班時間」表格中「迄」欄位的手寫內容
   - 輸出格式：HH:MM（24小時制，例如：09:00）

5. **加班事由**：找到「加 班 事 由」欄位的內容
   - **注意**：此欄位通常是印刷體/打字內容，不是手寫
   - **請讀取該欄位格子內的完整內容，包括括號內的補充說明**
   - **絕對不要讀取加 班 事 由」欄位右邊的「無法線上申請事由」欄位下方的印刷體/打字內容**
   - **只讀取表格主體內「加班事由」欄位中對應該列的完整文字**
   - 如果該欄位有多行文字，請完整讀取所有內容

6. **申請類別**：找到「加班」或「補休」欄位中的印刷體內容
   - 此欄位的值需要配合 「時數」 欄位來判斷, 「時數」 欄位不為 0 小時的選項才是申請類別的值
        -e.g. |加班費 | 0 小時 |
              |補休   | 2 小時 |
              申請類別的值應為: 補休
   - 可能的值：「加班費」、「補休」

7. **加班時數**：找到「時數」欄位的內容
   - 輸出為數值（例如：1.0）

**重要提醒**：
- 請辨識圖片中所有的加班記錄列，不要遺漏任何一筆
- 每一列都是一個獨立的 OvertimeEntry
- 如果某個欄位無法辨識，請填入「無法辨識」
- 時數如果無法辨識，請填入 0.0
"""

專案計劃書：智慧型加班單辨識自動化系統

1. 專案願景 (Project Vision)

打造一套輕量級、跨平台的桌面應用程式，旨在解決繁瑣的人工資料輸入痛點。透過結合新一代的多模態 AI 模型 (GPT-5 mini) 與現代化使用者介面，將手寫的加班單據自動轉化為結構化的數位報表，實現辦公流程的自動化與智慧化。

2. 核心架構與技術選型 (Core Architecture)

2.1 應用程式框架 (App Framework)

前端介面 (Frontend): 採用 Flet 框架。

選擇理由： Flet 能以 Python 語言快速構建現代化 UI，並具備優異的跨平台特性，確保在 Windows 與 macOS 雙系統上擁有一致且流暢的操作體驗。

核心引擎 (AI Engine): 採用 GPT-5 mini。

選擇理由： 利用其先進的視覺理解 (Vision) 與上下文推理能力，精準識別表格結構與繁體中文手寫內容，超越傳統 OCR 對格式與字跡的限制。

2.2 系統運行環境

本地端運行 (Local Execution): 應用程式將運行於使用者的本機電腦，無需架設複雜的後端伺服器。

跨平台支援: 支援 macOS (Apple Silicon/Intel) 與 Windows 10/11 環境。

3. 使用者工作流程設計 (User Workflow)

本系統設計強調「人機協作 (Human-in-the-loop)」，在自動化的同時保留人工校對的彈性。

數位化輸入 (Import):

使用者透過直覺的拖放 (Drag & Drop) 或檔案選取介面，批次匯入掃描後的加班單影像檔 (PDF/PNG/JPG)。

系統提供縮圖預覽，確認匯入順序與內容。

智慧辨識與處理 (AI Processing):

系統將影像傳送至 GPT-5 mini 引擎。

AI 針對使用者指定的「關鍵區域」（日期、時間、事由、時數）進行針對性的特徵提取。

AI 自動過濾表格中的印刷體雜訊，僅鎖定手寫筆跡進行數位化。

互動式校對 (Interactive Verification):

並排對照： 介面呈現「原始單據」與「辨識結果」的左右對照視圖。

快速修正： 使用者可直接在介面上的資料表格中修正 AI 誤判的文字（如潦草的數字或人名），確保資料 100% 正確。

結構化輸出 (Structured Export):

校對完成後，一鍵將所有資料彙整並匯出。

支援標準格式 (Excel/CSV)，以便直接匯入現有的差勤系統或進行後續統計。

4. 關鍵功能模組 (Key Modules)

為了保持系統的擴充性與維護性，專案將劃分為以下高層次模組：

A. 視覺介面模組 (UI Module)

負責所有與使用者互動的視覺元素，包括檔案上傳區、進度指示器、資料編輯表格與系統通知。

設計原則：極簡、直覺、減少操作步驟。

B. 影像前處理模組 (Image Pre-processing Module)

負責在傳送給 AI 之前優化影像品質。

包含影像壓縮、格式轉換與基本的雜訊處理，以提升傳輸效率並符合模型輸入規範。

C. 智慧提取模組 (Intelligence Extraction Module)

作為應用程式與 GPT-5 mini 之間的橋樑。

負責構建精確的提示詞 (Prompt Strategy)，引導 AI 理解表格的空間關係與欄位邏輯，確保回傳資料格式的穩定性。

D. 資料處理與輸出模組 (Data Handler Module)

負責將 AI 回傳的原始數據轉換為標準的表格結構。

處理資料型態的轉換（例如將字串 "14時16分" 格式化為標準時間格式）。

負責最終 Excel/CSV 檔案的生成與寫入。

5. 交付與部署策略 (Delivery Strategy)

獨立執行檔 (Standalone Executable):

將 Python 原始碼、依賴套件與 Flet 運行環境封裝為單一執行檔（Windows 為 .exe，Mac 為 .app 或 Unix executable）。

優勢： 終端使用者的電腦無需預先安裝 Python 環境或設定任何複雜參數，即開即用。

配置管理:

將敏感資訊（如 API Key）或可變動參數（如預設輸出路徑）抽離至外部設定檔或透過 UI 首次設定，方便未來管理與切換。

6. 下一步行動建議 (Next Steps)

原型驗證 (PoC): 先使用單張圖片測試 GPT-5 mini 對該特定手寫字跡的辨識能力，調整 Prompt 策略。

介面骨架搭建: 使用 Flet 快速建立 UI 草圖，確認操作動線流暢。

整合測試: 串接前後端，進行端對端的資料流測試。